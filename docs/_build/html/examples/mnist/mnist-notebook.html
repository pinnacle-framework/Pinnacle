<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Hello World: handwritten digit recognition with SuperDuperDB &mdash; SuperDuperDB  documentation</title>
      <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/nbsphinx-code-cells.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/custom.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/doctools.js"></script>
        <script src="../../_static/sphinx_highlight.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
        <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="CoCo (Common Objects in Context) Dataset" href="../coco/index.html" />
    <link rel="prev" title="MNIST Dataset" href="index.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../index.html" class="icon icon-home">
            SuperDuperDB
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../getting_started.html">Quick  start</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../minimum_working_example.html">Minimum working example</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">Tutorials and examples</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="index.html">MNIST Dataset</a><ul class="current">
<li class="toctree-l3 current"><a class="current reference internal" href="#">Hello World: handwritten digit recognition with SuperDuperDB</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../coco/index.html">CoCo (Common Objects in Context) Dataset</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../concepts.html">SuperDuperDB Concepts</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../types.html">Types in SuperDuperDB</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../content.html">Adding interesting content to SuperDuperDB</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../models.html">Models - an extension of PyTorch models</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../watchers.html">Watchers in SuperDuperDB</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../semantic_indexes.html">Semantic indexes for flexibly searching data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../imputations.html">Imputations for filling in data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../jobs.html">Jobs - scheduling of training and model outputs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../cluster.html">Setting up a SuperDuperDB cluster</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../full_usage.html">Full usage</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">SuperDuperDB</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../index.html">Tutorials and examples</a></li>
          <li class="breadcrumb-item"><a href="index.html">MNIST Dataset</a></li>
      <li class="breadcrumb-item active">Hello World: handwritten digit recognition with SuperDuperDB</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../_sources/examples/mnist/mnist-notebook.ipynb.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="Hello-World:-handwritten-digit-recognition-with-SuperDuperDB">
<h1>Hello World: handwritten digit recognition with SuperDuperDB<a class="headerlink" href="#Hello-World:-handwritten-digit-recognition-with-SuperDuperDB" title="Permalink to this heading">ÔÉÅ</a></h1>
<p>In this tutorial, we implement the classic MNIST handwritten digits recognition task in SuperDuperDB.</p>
<p>First we import the SuperDuperDB client, and create a fresh collection.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pinnacledb.client</span> <span class="kn">import</span> <span class="n">the_client</span>
<span class="kn">import</span> <span class="nn">torchvision</span>

<span class="n">docs</span> <span class="o">=</span> <span class="n">the_client</span><span class="o">.</span><span class="n">mnist</span><span class="o">.</span><span class="n">digits</span>
</pre></div>
</div>
</div>
<p>The data is available as <code class="docutils literal notranslate"><span class="pre">PIL.Image</span></code> images with labels in the <code class="docutils literal notranslate"><span class="pre">torchvision</span></code> package:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">random</span>

<span class="n">mnist_data</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">torchvision</span><span class="o">.</span><span class="n">datasets</span><span class="o">.</span><span class="n">MNIST</span><span class="p">(</span><span class="n">root</span><span class="o">=</span><span class="s1">&#39;./data&#39;</span><span class="p">,</span> <span class="n">download</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
<span class="n">random</span><span class="o">.</span><span class="n">shuffle</span><span class="p">(</span><span class="n">mnist_data</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>SuperDuperDB is based on MongoDB, which does not support images and tensors and other special data types out of the box. In order to remedy this, we create custom SuperDuperDB <strong>types</strong>. These types handle:</p>
<ul class="simple">
<li><p>How to store images as bytes in SuperDuperDB and how to reinstantiate the images from the bytes</p></li>
<li><p>How to store tensors in SuperDuperDB and how to retrieve these from the database again</p></li>
</ul>
<p>We do this by creating the classes in python with <code class="docutils literal notranslate"><span class="pre">.encode</span></code> and <code class="docutils literal notranslate"><span class="pre">.decode</span></code> methods:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">!</span>pygmentize<span class="w"> </span>examples/types.py
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
<span class="ansi-bold" style="color: rgb(0,128,0)">import</span> <span class="ansi-bold" style="color: rgb(0,0,255)">io</span>
<span class="ansi-bold" style="color: rgb(0,128,0)">import</span> <span class="ansi-bold" style="color: rgb(0,0,255)">numpy</span>
<span class="ansi-bold" style="color: rgb(0,128,0)">import</span> <span class="ansi-bold" style="color: rgb(0,0,255)">PIL</span><span class="ansi-bold" style="color: rgb(0,0,255)">.</span><span class="ansi-bold" style="color: rgb(0,0,255)">Image</span>
<span class="ansi-bold" style="color: rgb(0,128,0)">import</span> <span class="ansi-bold" style="color: rgb(0,0,255)">PIL</span><span class="ansi-bold" style="color: rgb(0,0,255)">.</span><span class="ansi-bold" style="color: rgb(0,0,255)">JpegImagePlugin</span>
<span class="ansi-bold" style="color: rgb(0,128,0)">import</span> <span class="ansi-bold" style="color: rgb(0,0,255)">torch</span>


<span class="ansi-bold" style="color: rgb(0,128,0)">class</span> <span class="ansi-bold" style="color: rgb(0,0,255)">Image</span>:
    types <span style="color: rgb(102,102,102)">=</span> (PIL<span style="color: rgb(102,102,102)">.</span>JpegImagePlugin<span style="color: rgb(102,102,102)">.</span>JpegImageFile, PIL<span style="color: rgb(102,102,102)">.</span>Image<span style="color: rgb(102,102,102)">.</span>Image)

    <span style="color: rgb(170,34,255)">@staticmethod</span>
    <span class="ansi-bold" style="color: rgb(0,128,0)">def</span> <span style="color: rgb(0,0,255)">encode</span>(x):
        buffer <span style="color: rgb(102,102,102)">=</span> io<span style="color: rgb(102,102,102)">.</span>BytesIO()
        x<span style="color: rgb(102,102,102)">.</span>save(buffer, <span style="color: rgb(0,128,0)">format</span><span style="color: rgb(102,102,102)">=</span><span style="color: rgb(186,33,33)">&#39;</span><span style="color: rgb(186,33,33)">png</span><span style="color: rgb(186,33,33)">&#39;</span>)
        <span class="ansi-bold" style="color: rgb(0,128,0)">return</span> buffer<span style="color: rgb(102,102,102)">.</span>getvalue()

    <span style="color: rgb(170,34,255)">@staticmethod</span>
    <span class="ansi-bold" style="color: rgb(0,128,0)">def</span> <span style="color: rgb(0,0,255)">decode</span>(bytes_):
        <span class="ansi-bold" style="color: rgb(0,128,0)">return</span> PIL<span style="color: rgb(102,102,102)">.</span>Image<span style="color: rgb(102,102,102)">.</span>open(io<span style="color: rgb(102,102,102)">.</span>BytesIO(bytes_))


<span class="ansi-bold" style="color: rgb(0,128,0)">class</span> <span class="ansi-bold" style="color: rgb(0,0,255)">FloatTensor</span>:
    types <span style="color: rgb(102,102,102)">=</span> (torch<span style="color: rgb(102,102,102)">.</span>FloatTensor, torch<span style="color: rgb(102,102,102)">.</span>Tensor)

    <span style="color: rgb(170,34,255)">@staticmethod</span>
    <span class="ansi-bold" style="color: rgb(0,128,0)">def</span> <span style="color: rgb(0,0,255)">encode</span>(x):
        x <span style="color: rgb(102,102,102)">=</span> x<span style="color: rgb(102,102,102)">.</span>numpy()
        <span class="ansi-bold" style="color: rgb(0,128,0)">assert</span> x<span style="color: rgb(102,102,102)">.</span>dtype <span style="color: rgb(102,102,102)">==</span> numpy<span style="color: rgb(102,102,102)">.</span>float32
        <span class="ansi-bold" style="color: rgb(0,128,0)">return</span> <span style="color: rgb(0,128,0)">memoryview</span>(x)<span style="color: rgb(102,102,102)">.</span>tobytes()

    <span style="color: rgb(170,34,255)">@staticmethod</span>
    <span class="ansi-bold" style="color: rgb(0,128,0)">def</span> <span style="color: rgb(0,0,255)">decode</span>(bytes_):
        array <span style="color: rgb(102,102,102)">=</span> numpy<span style="color: rgb(102,102,102)">.</span>frombuffer(bytes_, dtype<span style="color: rgb(102,102,102)">=</span>numpy<span style="color: rgb(102,102,102)">.</span>float32)
        <span class="ansi-bold" style="color: rgb(0,128,0)">return</span> torch<span style="color: rgb(102,102,102)">.</span>from_numpy(array)<span style="color: rgb(102,102,102)">.</span>type(torch<span style="color: rgb(102,102,102)">.</span>float)
</pre></div></div>
</div>
<p>Once these classes are ready, one can import the classes, and add instances of these to SuperDuperDB, giving each type a suitable name:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">examples.types</span> <span class="kn">import</span> <span class="n">Image</span><span class="p">,</span> <span class="n">FloatTensor</span>

<span class="n">docs</span><span class="o">.</span><span class="n">create_type</span><span class="p">(</span><span class="s1">&#39;image&#39;</span><span class="p">,</span> <span class="n">Image</span><span class="p">)</span>
<span class="n">docs</span><span class="o">.</span><span class="n">create_type</span><span class="p">(</span><span class="s1">&#39;float_tensor&#39;</span><span class="p">,</span> <span class="n">FloatTensor</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>Now we have these custom types, we can insert the data into SuperDuperDB:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">docs</span><span class="o">.</span><span class="n">insert_many</span><span class="p">([{</span><span class="s1">&#39;img&#39;</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;class&#39;</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]}</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">mnist_data</span><span class="p">[:</span><span class="o">-</span><span class="mi">1000</span><span class="p">]])</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
downloading content from retrieved urls
found 0 urls
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;pymongo.results.InsertManyResult at 0x1648c44f0&gt;
</pre></div></div>
</div>
<p>You‚Äôll see that when we fetch data from the database, it‚Äôs in exactly the form that we want.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">docs</span><span class="o">.</span><span class="n">find_one</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
{&#39;_id&#39;: ObjectId(&#39;640939c0deb71bb414652022&#39;),
 &#39;img&#39;: &lt;PIL.PngImagePlugin.PngImageFile image mode=L size=28x28&gt;,
 &#39;class&#39;: 9,
 &#39;_fold&#39;: &#39;train&#39;}
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">docs</span><span class="o">.</span><span class="n">find_one</span><span class="p">()[</span><span class="s1">&#39;img&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="output_area docutils container">
<img alt="../../_images/examples_mnist_mnist-notebook_13_0.png" src="../../_images/examples_mnist_mnist-notebook_13_0.png" />
</div>
</div>
<p>Now that we‚Äôve added the data to SuperDuperDB, we‚Äôre ready to create a model. This is a simple PyTorch model implementing the iconic <a class="reference external" href="https://en.wikipedia.org/wiki/LeNet">LeNet architecture</a>. In addition to the standard PyTorch <code class="docutils literal notranslate"><span class="pre">.forward</span></code> method, SuperDuperDB allows users to specify <code class="docutils literal notranslate"><span class="pre">.preprocess</span></code> and <code class="docutils literal notranslate"><span class="pre">.postprocess</span></code> methods which define respectively:</p>
<ul class="simple">
<li><p>how the data is converted from the in-database form, to tensor</p></li>
<li><p>from the output form back into the form to be stored in the database</p></li>
</ul>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">!</span>pygmentize<span class="w"> </span>examples/mnist/models.py
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
<span class="ansi-bold" style="color: rgb(0,128,0)">import</span> <span class="ansi-bold" style="color: rgb(0,0,255)">torch</span>
<span class="ansi-bold" style="color: rgb(0,128,0)">from</span> <span class="ansi-bold" style="color: rgb(0,0,255)">torchvision</span> <span class="ansi-bold" style="color: rgb(0,128,0)">import</span> transforms


<span class="ansi-bold" style="color: rgb(0,128,0)">def</span> <span style="color: rgb(0,0,255)">label</span>(x):
    <span class="ansi-bold" style="color: rgb(0,128,0)">return</span> torch<span style="color: rgb(102,102,102)">.</span>tensor(x)


<span class="ansi-bold" style="color: rgb(0,128,0)">class</span> <span class="ansi-bold" style="color: rgb(0,0,255)">LeNet5</span>(torch<span style="color: rgb(102,102,102)">.</span>nn<span style="color: rgb(102,102,102)">.</span>Module):
    <span class="ansi-bold" style="color: rgb(0,128,0)">def</span> <span style="color: rgb(0,0,255)">__init__</span>(<span style="color: rgb(0,128,0)">self</span>, num_classes):
        <span style="color: rgb(0,128,0)">super</span>()<span style="color: rgb(102,102,102)">.</span><span style="color: rgb(0,0,255)">__init__</span>()
        <span style="color: rgb(0,128,0)">self</span><span style="color: rgb(102,102,102)">.</span>layer1 <span style="color: rgb(102,102,102)">=</span> torch<span style="color: rgb(102,102,102)">.</span>nn<span style="color: rgb(102,102,102)">.</span>Sequential(
            torch<span style="color: rgb(102,102,102)">.</span>nn<span style="color: rgb(102,102,102)">.</span>Conv2d(<span style="color: rgb(102,102,102)">1</span>, <span style="color: rgb(102,102,102)">6</span>, kernel_size<span style="color: rgb(102,102,102)">=</span><span style="color: rgb(102,102,102)">5</span>, stride<span style="color: rgb(102,102,102)">=</span><span style="color: rgb(102,102,102)">1</span>, padding<span style="color: rgb(102,102,102)">=</span><span style="color: rgb(102,102,102)">0</span>),
            torch<span style="color: rgb(102,102,102)">.</span>nn<span style="color: rgb(102,102,102)">.</span>BatchNorm2d(<span style="color: rgb(102,102,102)">6</span>),
            torch<span style="color: rgb(102,102,102)">.</span>nn<span style="color: rgb(102,102,102)">.</span>ReLU(),
            torch<span style="color: rgb(102,102,102)">.</span>nn<span style="color: rgb(102,102,102)">.</span>MaxPool2d(kernel_size<span style="color: rgb(102,102,102)">=</span><span style="color: rgb(102,102,102)">2</span>, stride<span style="color: rgb(102,102,102)">=</span><span style="color: rgb(102,102,102)">2</span>))
        <span style="color: rgb(0,128,0)">self</span><span style="color: rgb(102,102,102)">.</span>layer2 <span style="color: rgb(102,102,102)">=</span> torch<span style="color: rgb(102,102,102)">.</span>nn<span style="color: rgb(102,102,102)">.</span>Sequential(
            torch<span style="color: rgb(102,102,102)">.</span>nn<span style="color: rgb(102,102,102)">.</span>Conv2d(<span style="color: rgb(102,102,102)">6</span>, <span style="color: rgb(102,102,102)">16</span>, kernel_size<span style="color: rgb(102,102,102)">=</span><span style="color: rgb(102,102,102)">5</span>, stride<span style="color: rgb(102,102,102)">=</span><span style="color: rgb(102,102,102)">1</span>, padding<span style="color: rgb(102,102,102)">=</span><span style="color: rgb(102,102,102)">0</span>),
            torch<span style="color: rgb(102,102,102)">.</span>nn<span style="color: rgb(102,102,102)">.</span>BatchNorm2d(<span style="color: rgb(102,102,102)">16</span>),
            torch<span style="color: rgb(102,102,102)">.</span>nn<span style="color: rgb(102,102,102)">.</span>ReLU(),
            torch<span style="color: rgb(102,102,102)">.</span>nn<span style="color: rgb(102,102,102)">.</span>MaxPool2d(kernel_size<span style="color: rgb(102,102,102)">=</span><span style="color: rgb(102,102,102)">2</span>, stride<span style="color: rgb(102,102,102)">=</span><span style="color: rgb(102,102,102)">2</span>))
        <span style="color: rgb(0,128,0)">self</span><span style="color: rgb(102,102,102)">.</span>fc <span style="color: rgb(102,102,102)">=</span> torch<span style="color: rgb(102,102,102)">.</span>nn<span style="color: rgb(102,102,102)">.</span>Linear(<span style="color: rgb(102,102,102)">400</span>, <span style="color: rgb(102,102,102)">120</span>)
        <span style="color: rgb(0,128,0)">self</span><span style="color: rgb(102,102,102)">.</span>relu <span style="color: rgb(102,102,102)">=</span> torch<span style="color: rgb(102,102,102)">.</span>nn<span style="color: rgb(102,102,102)">.</span>ReLU()
        <span style="color: rgb(0,128,0)">self</span><span style="color: rgb(102,102,102)">.</span>fc1 <span style="color: rgb(102,102,102)">=</span> torch<span style="color: rgb(102,102,102)">.</span>nn<span style="color: rgb(102,102,102)">.</span>Linear(<span style="color: rgb(102,102,102)">120</span>, <span style="color: rgb(102,102,102)">84</span>)
        <span style="color: rgb(0,128,0)">self</span><span style="color: rgb(102,102,102)">.</span>relu1 <span style="color: rgb(102,102,102)">=</span> torch<span style="color: rgb(102,102,102)">.</span>nn<span style="color: rgb(102,102,102)">.</span>ReLU()
        <span style="color: rgb(0,128,0)">self</span><span style="color: rgb(102,102,102)">.</span>fc2 <span style="color: rgb(102,102,102)">=</span> torch<span style="color: rgb(102,102,102)">.</span>nn<span style="color: rgb(102,102,102)">.</span>Linear(<span style="color: rgb(102,102,102)">84</span>, num_classes)

    <span class="ansi-bold" style="color: rgb(0,128,0)">def</span> <span style="color: rgb(0,0,255)">preprocess</span>(<span style="color: rgb(0,128,0)">self</span>, x):
        <span class="ansi-bold" style="color: rgb(0,128,0)">return</span> transforms<span style="color: rgb(102,102,102)">.</span>Compose([
            transforms<span style="color: rgb(102,102,102)">.</span>Resize((<span style="color: rgb(102,102,102)">32</span>, <span style="color: rgb(102,102,102)">32</span>)),
            transforms<span style="color: rgb(102,102,102)">.</span>ToTensor(),
            transforms<span style="color: rgb(102,102,102)">.</span>Normalize(mean<span style="color: rgb(102,102,102)">=</span>(<span style="color: rgb(102,102,102)">0.1307</span>,), std<span style="color: rgb(102,102,102)">=</span>(<span style="color: rgb(102,102,102)">0.3081</span>,))]
        )(x)

    <span class="ansi-bold" style="color: rgb(0,128,0)">def</span> <span style="color: rgb(0,0,255)">forward</span>(<span style="color: rgb(0,128,0)">self</span>, x):
        out <span style="color: rgb(102,102,102)">=</span> <span style="color: rgb(0,128,0)">self</span><span style="color: rgb(102,102,102)">.</span>layer1(x)
        out <span style="color: rgb(102,102,102)">=</span> <span style="color: rgb(0,128,0)">self</span><span style="color: rgb(102,102,102)">.</span>layer2(out)
        out <span style="color: rgb(102,102,102)">=</span> out<span style="color: rgb(102,102,102)">.</span>reshape(out<span style="color: rgb(102,102,102)">.</span>size(<span style="color: rgb(102,102,102)">0</span>), <span style="color: rgb(102,102,102)">-</span><span style="color: rgb(102,102,102)">1</span>)
        out <span style="color: rgb(102,102,102)">=</span> <span style="color: rgb(0,128,0)">self</span><span style="color: rgb(102,102,102)">.</span>fc(out)
        out <span style="color: rgb(102,102,102)">=</span> <span style="color: rgb(0,128,0)">self</span><span style="color: rgb(102,102,102)">.</span>relu(out)
        out <span style="color: rgb(102,102,102)">=</span> <span style="color: rgb(0,128,0)">self</span><span style="color: rgb(102,102,102)">.</span>fc1(out)
        out <span style="color: rgb(102,102,102)">=</span> <span style="color: rgb(0,128,0)">self</span><span style="color: rgb(102,102,102)">.</span>relu1(out)
        out <span style="color: rgb(102,102,102)">=</span> <span style="color: rgb(0,128,0)">self</span><span style="color: rgb(102,102,102)">.</span>fc2(out)
        <span class="ansi-bold" style="color: rgb(0,128,0)">return</span> out

    <span class="ansi-bold" style="color: rgb(0,128,0)">def</span> <span style="color: rgb(0,0,255)">postprocess</span>(<span style="color: rgb(0,128,0)">self</span>, x):
        <span class="ansi-bold" style="color: rgb(0,128,0)">return</span> <span style="color: rgb(0,128,0)">int</span>(x<span style="color: rgb(102,102,102)">.</span>topk(<span style="color: rgb(102,102,102)">1</span>)[<span style="color: rgb(102,102,102)">1</span>]<span style="color: rgb(102,102,102)">.</span>item())
</pre></div></div>
</div>
<p>Let‚Äôs test this model on a single image. <code class="docutils literal notranslate"><span class="pre">Collection.apply_model</span></code> applies serially the <code class="docutils literal notranslate"><span class="pre">preprocess</span></code>, <code class="docutils literal notranslate"><span class="pre">forward</span></code> and <code class="docutils literal notranslate"><span class="pre">postprocess</span></code> methods, creating a singleton batch prior to the <code class="docutils literal notranslate"><span class="pre">forward</span></code> and unpacking the batch after the <code class="docutils literal notranslate"><span class="pre">forward</span></code>.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">examples.mnist.models</span> <span class="kn">import</span> <span class="n">LeNet5</span><span class="p">,</span> <span class="n">label</span>

<span class="n">docs</span><span class="o">.</span><span class="n">apply_model</span><span class="p">(</span><span class="n">LeNet5</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span> <span class="n">docs</span><span class="o">.</span><span class="n">find</span><span class="p">()[</span><span class="mi">23</span><span class="p">][</span><span class="s1">&#39;img&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
2
</pre></div></div>
</div>
<p>Now that we have our model we need a target for learning - for this we use <code class="docutils literal notranslate"><span class="pre">label</span></code>:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">docs</span><span class="o">.</span><span class="n">create_model</span><span class="p">(</span><span class="s1">&#39;lenet&#39;</span><span class="p">,</span> <span class="n">LeNet5</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span>
<span class="n">docs</span><span class="o">.</span><span class="n">create_function</span><span class="p">(</span><span class="s1">&#39;label&#39;</span><span class="p">,</span> <span class="n">label</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>Finally we need a loss function - this is a vanilla <code class="docutils literal notranslate"><span class="pre">torch</span></code> function, so we don‚Äôt need to write extra code:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">torch</span>

<span class="n">docs</span><span class="o">.</span><span class="n">create_objective</span><span class="p">(</span><span class="s1">&#39;classification&#39;</span><span class="p">,</span> <span class="n">torch</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">CrossEntropyLoss</span><span class="p">())</span>
</pre></div>
</div>
</div>
<p>And a metric to measure performance:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">!</span>pygmentize<span class="w"> </span>examples/mnist/metrics.py
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
<span class="ansi-bold" style="color: rgb(0,128,0)">def</span> <span style="color: rgb(0,0,255)">accuracy</span>(x, y):
    <span class="ansi-bold" style="color: rgb(0,128,0)">return</span> x <span style="color: rgb(102,102,102)">==</span> y
</pre></div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">examples.mnist.metrics</span> <span class="kn">import</span> <span class="n">accuracy</span>

<span class="n">docs</span><span class="o">.</span><span class="n">create_metric</span><span class="p">(</span><span class="s1">&#39;accuracy&#39;</span><span class="p">,</span> <span class="n">accuracy</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>When measuring performance, SuperDuperDB requires users to create a separate validation set, which is saved for posterity and reproducibility reasons - edits and deletes on the main collection don‚Äôt affect this validation set.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">docs</span><span class="o">.</span><span class="n">create_validation_set</span><span class="p">(</span><span class="s1">&#39;classification&#39;</span><span class="p">,</span> <span class="n">sample_size</span><span class="o">=</span><span class="mi">250</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "e3b28d18b1d64c73bd870f38c5e298fc", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
downloading content from retrieved urls
found 0 urls
</pre></div></div>
</div>
<p>Now we‚Äôre ready to create the model using the <code class="docutils literal notranslate"><span class="pre">Collection.create_imputation</span></code>. This trains a model to predict one part of the data using another part, specified respectively by <code class="docutils literal notranslate"><span class="pre">model_key</span></code> and <code class="docutils literal notranslate"><span class="pre">target_key</span></code>; these are subkeys of the collection documents.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">docs</span><span class="o">.</span><span class="n">create_imputation</span><span class="p">(</span>
    <span class="n">name</span><span class="o">=</span><span class="s1">&#39;predictor&#39;</span><span class="p">,</span>
    <span class="n">model</span><span class="o">=</span><span class="s1">&#39;lenet&#39;</span><span class="p">,</span>
    <span class="n">model_key</span><span class="o">=</span><span class="s1">&#39;img&#39;</span><span class="p">,</span>
    <span class="n">target</span><span class="o">=</span><span class="s1">&#39;label&#39;</span><span class="p">,</span>
    <span class="n">target_key</span><span class="o">=</span><span class="s1">&#39;class&#39;</span><span class="p">,</span>
    <span class="n">objective</span><span class="o">=</span><span class="s1">&#39;classification&#39;</span><span class="p">,</span>
    <span class="n">metrics</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;accuracy&#39;</span><span class="p">],</span>
    <span class="n">n_iterations</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span>
    <span class="n">validation_interval</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span>
    <span class="n">validation_sets</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;classification&#39;</span><span class="p">,)</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
downloading ids for {&#39;_fold&#39;: &#39;train&#39;}
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "13cf6e9d990044639d0df96ca5bb0622", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
downloading records for {&#39;_fold&#39;: &#39;valid&#39;}
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "b03310a7e13c46d088bbf637d4cdff0a", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "10361cd272f647b3951b61fe79b6537f", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
fold: VALID; iteration: 0; epoch: 0; classification/accuracy: 0.128; objective: 2.3055715958277383;
fold: TRAIN; iteration: 0; epoch: 0; objective: 2.310838222503662;
fold: TRAIN; iteration: 1; epoch: 0; objective: 2.3019590377807617;
fold: TRAIN; iteration: 2; epoch: 0; objective: 2.2987663745880127;
fold: TRAIN; iteration: 3; epoch: 0; objective: 2.2918174266815186;
fold: TRAIN; iteration: 4; epoch: 0; objective: 2.3130290508270264;
fold: TRAIN; iteration: 5; epoch: 0; objective: 2.2971832752227783;
fold: TRAIN; iteration: 6; epoch: 0; objective: 2.2927095890045166;
fold: TRAIN; iteration: 7; epoch: 0; objective: 2.2802178859710693;
fold: TRAIN; iteration: 8; epoch: 0; objective: 2.2643985748291016;
fold: TRAIN; iteration: 9; epoch: 0; objective: 2.2746851444244385;
fold: TRAIN; iteration: 10; epoch: 0; objective: 2.2708656787872314;
fold: TRAIN; iteration: 11; epoch: 0; objective: 2.2572407722473145;
fold: TRAIN; iteration: 12; epoch: 0; objective: 2.2763054370880127;
fold: TRAIN; iteration: 13; epoch: 0; objective: 2.2742810249328613;
fold: TRAIN; iteration: 14; epoch: 0; objective: 2.240481376647949;
fold: TRAIN; iteration: 15; epoch: 0; objective: 2.2443747520446777;
fold: TRAIN; iteration: 16; epoch: 0; objective: 2.2417118549346924;
fold: TRAIN; iteration: 17; epoch: 0; objective: 2.2242300510406494;
fold: TRAIN; iteration: 18; epoch: 0; objective: 2.230186700820923;
fold: TRAIN; iteration: 19; epoch: 0; objective: 2.2232446670532227;
fold: TRAIN; iteration: 20; epoch: 0; objective: 2.23201060295105;
fold: TRAIN; iteration: 21; epoch: 0; objective: 2.221383571624756;
fold: TRAIN; iteration: 22; epoch: 0; objective: 2.231064558029175;
fold: TRAIN; iteration: 23; epoch: 0; objective: 2.189814805984497;
fold: TRAIN; iteration: 24; epoch: 0; objective: 2.2066588401794434;
fold: TRAIN; iteration: 25; epoch: 0; objective: 2.20032000541687;
fold: TRAIN; iteration: 26; epoch: 0; objective: 2.1905267238616943;
fold: TRAIN; iteration: 27; epoch: 0; objective: 2.191971778869629;
fold: TRAIN; iteration: 28; epoch: 0; objective: 2.222308874130249;
fold: TRAIN; iteration: 29; epoch: 0; objective: 2.1937296390533447;
fold: TRAIN; iteration: 30; epoch: 0; objective: 2.201678514480591;
fold: TRAIN; iteration: 31; epoch: 0; objective: 2.186317205429077;
fold: TRAIN; iteration: 32; epoch: 0; objective: 2.1836304664611816;
fold: TRAIN; iteration: 33; epoch: 0; objective: 2.152305841445923;
fold: TRAIN; iteration: 34; epoch: 0; objective: 2.1612279415130615;
fold: TRAIN; iteration: 35; epoch: 0; objective: 2.1549460887908936;
fold: TRAIN; iteration: 36; epoch: 0; objective: 2.123807430267334;
fold: TRAIN; iteration: 37; epoch: 0; objective: 2.1742539405822754;
fold: TRAIN; iteration: 38; epoch: 0; objective: 2.1392128467559814;
fold: TRAIN; iteration: 39; epoch: 0; objective: 2.118628740310669;
fold: TRAIN; iteration: 40; epoch: 0; objective: 2.098876953125;
fold: TRAIN; iteration: 41; epoch: 0; objective: 2.1176273822784424;
fold: TRAIN; iteration: 42; epoch: 0; objective: 2.095907688140869;
fold: TRAIN; iteration: 43; epoch: 0; objective: 2.0902345180511475;
fold: TRAIN; iteration: 44; epoch: 0; objective: 2.1053011417388916;
fold: TRAIN; iteration: 45; epoch: 0; objective: 2.097560167312622;
fold: TRAIN; iteration: 46; epoch: 0; objective: 2.1280877590179443;
fold: TRAIN; iteration: 47; epoch: 0; objective: 2.0910983085632324;
fold: TRAIN; iteration: 48; epoch: 0; objective: 2.085329532623291;
fold: TRAIN; iteration: 49; epoch: 0; objective: 2.0326993465423584;
validating model...
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "1e8b62829a0f4207b4a08af61cc04bd9", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
saving
fold: VALID; iteration: 50; epoch: 0; classification/accuracy: 0.636; objective: 2.054457982381185;
fold: TRAIN; iteration: 50; epoch: 0; objective: 2.0717613697052;
fold: TRAIN; iteration: 51; epoch: 0; objective: 2.0102880001068115;
fold: TRAIN; iteration: 52; epoch: 0; objective: 2.069875717163086;
fold: TRAIN; iteration: 53; epoch: 0; objective: 2.0292677879333496;
fold: TRAIN; iteration: 54; epoch: 0; objective: 2.004089832305908;
fold: TRAIN; iteration: 55; epoch: 0; objective: 2.0182459354400635;
fold: TRAIN; iteration: 56; epoch: 0; objective: 2.0281577110290527;
fold: TRAIN; iteration: 57; epoch: 0; objective: 1.9787588119506836;
fold: TRAIN; iteration: 58; epoch: 0; objective: 1.9663032293319702;
fold: TRAIN; iteration: 59; epoch: 0; objective: 2.023878574371338;
fold: TRAIN; iteration: 60; epoch: 0; objective: 1.9459357261657715;
fold: TRAIN; iteration: 61; epoch: 0; objective: 1.9742985963821411;
fold: TRAIN; iteration: 62; epoch: 0; objective: 1.980777621269226;
fold: TRAIN; iteration: 63; epoch: 0; objective: 1.9434759616851807;
fold: TRAIN; iteration: 64; epoch: 0; objective: 1.9335590600967407;
fold: TRAIN; iteration: 65; epoch: 0; objective: 1.9321327209472656;
fold: TRAIN; iteration: 66; epoch: 0; objective: 1.853693962097168;
fold: TRAIN; iteration: 67; epoch: 0; objective: 1.9227592945098877;
fold: TRAIN; iteration: 68; epoch: 0; objective: 1.8437542915344238;
fold: TRAIN; iteration: 69; epoch: 0; objective: 1.8896273374557495;
fold: TRAIN; iteration: 70; epoch: 0; objective: 1.910170316696167;
fold: TRAIN; iteration: 71; epoch: 0; objective: 1.8621375560760498;
fold: TRAIN; iteration: 72; epoch: 0; objective: 1.8786550760269165;
fold: TRAIN; iteration: 73; epoch: 0; objective: 1.8270928859710693;
fold: TRAIN; iteration: 74; epoch: 0; objective: 1.8318077325820923;
fold: TRAIN; iteration: 75; epoch: 0; objective: 1.820070743560791;
fold: TRAIN; iteration: 76; epoch: 0; objective: 1.809736967086792;
fold: TRAIN; iteration: 77; epoch: 0; objective: 1.7768149375915527;
fold: TRAIN; iteration: 78; epoch: 0; objective: 1.8290742635726929;
fold: TRAIN; iteration: 79; epoch: 0; objective: 1.814958095550537;
fold: TRAIN; iteration: 80; epoch: 0; objective: 1.7288267612457275;
fold: TRAIN; iteration: 81; epoch: 0; objective: 1.7588648796081543;
fold: TRAIN; iteration: 82; epoch: 0; objective: 1.7029422521591187;
fold: TRAIN; iteration: 83; epoch: 0; objective: 1.774856686592102;
fold: TRAIN; iteration: 84; epoch: 0; objective: 1.7120606899261475;
fold: TRAIN; iteration: 85; epoch: 0; objective: 1.7923997640609741;
fold: TRAIN; iteration: 86; epoch: 0; objective: 1.7656019926071167;
fold: TRAIN; iteration: 87; epoch: 0; objective: 1.6691231727600098;
fold: TRAIN; iteration: 88; epoch: 0; objective: 1.6414614915847778;
fold: TRAIN; iteration: 89; epoch: 0; objective: 1.6890171766281128;
fold: TRAIN; iteration: 90; epoch: 0; objective: 1.7111713886260986;
fold: TRAIN; iteration: 91; epoch: 0; objective: 1.685795783996582;
fold: TRAIN; iteration: 92; epoch: 0; objective: 1.5962841510772705;
fold: TRAIN; iteration: 93; epoch: 0; objective: 1.5551676750183105;
fold: TRAIN; iteration: 94; epoch: 0; objective: 1.5782983303070068;
fold: TRAIN; iteration: 95; epoch: 0; objective: 1.666873812675476;
fold: TRAIN; iteration: 96; epoch: 0; objective: 1.4971923828125;
fold: TRAIN; iteration: 97; epoch: 0; objective: 1.4665902853012085;
fold: TRAIN; iteration: 98; epoch: 0; objective: 1.550472617149353;
fold: TRAIN; iteration: 99; epoch: 0; objective: 1.5015666484832764;
validating model...
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "7de1864b1fe54a498bee14147aa479ba", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
saving
fold: VALID; iteration: 100; epoch: 0; classification/accuracy: 0.748; objective: 1.5308185736338298;
fold: TRAIN; iteration: 100; epoch: 0; objective: 1.5345566272735596;
fold: TRAIN; iteration: 101; epoch: 0; objective: 1.5447643995285034;
fold: TRAIN; iteration: 102; epoch: 0; objective: 1.4872162342071533;
fold: TRAIN; iteration: 103; epoch: 0; objective: 1.453231930732727;
fold: TRAIN; iteration: 104; epoch: 0; objective: 1.4502145051956177;
fold: TRAIN; iteration: 105; epoch: 0; objective: 1.429458737373352;
fold: TRAIN; iteration: 106; epoch: 0; objective: 1.42157781124115;
fold: TRAIN; iteration: 107; epoch: 0; objective: 1.4337852001190186;
fold: TRAIN; iteration: 108; epoch: 0; objective: 1.5017353296279907;
fold: TRAIN; iteration: 109; epoch: 0; objective: 1.4283941984176636;
fold: TRAIN; iteration: 110; epoch: 0; objective: 1.3568757772445679;
fold: TRAIN; iteration: 111; epoch: 0; objective: 1.3992199897766113;
fold: TRAIN; iteration: 112; epoch: 0; objective: 1.2998061180114746;
fold: TRAIN; iteration: 113; epoch: 0; objective: 1.348673701286316;
fold: TRAIN; iteration: 114; epoch: 0; objective: 1.3355510234832764;
fold: TRAIN; iteration: 115; epoch: 0; objective: 1.3205708265304565;
fold: TRAIN; iteration: 116; epoch: 0; objective: 1.356518268585205;
fold: TRAIN; iteration: 117; epoch: 0; objective: 1.3585901260375977;
fold: TRAIN; iteration: 118; epoch: 0; objective: 1.2454502582550049;
fold: TRAIN; iteration: 119; epoch: 0; objective: 1.2127875089645386;
fold: TRAIN; iteration: 120; epoch: 0; objective: 1.254333734512329;
fold: TRAIN; iteration: 121; epoch: 0; objective: 1.2212485074996948;
fold: TRAIN; iteration: 122; epoch: 0; objective: 1.391768217086792;
fold: TRAIN; iteration: 123; epoch: 0; objective: 1.1916247606277466;
fold: TRAIN; iteration: 124; epoch: 0; objective: 1.2337502241134644;
fold: TRAIN; iteration: 125; epoch: 0; objective: 1.1357847452163696;
fold: TRAIN; iteration: 126; epoch: 0; objective: 1.2383034229278564;
fold: TRAIN; iteration: 127; epoch: 0; objective: 1.1987026929855347;
fold: TRAIN; iteration: 128; epoch: 0; objective: 1.1135581731796265;
fold: TRAIN; iteration: 129; epoch: 0; objective: 1.2195497751235962;
fold: TRAIN; iteration: 130; epoch: 0; objective: 1.0503194332122803;
fold: TRAIN; iteration: 131; epoch: 0; objective: 1.1405937671661377;
fold: TRAIN; iteration: 132; epoch: 0; objective: 1.0727030038833618;
fold: TRAIN; iteration: 133; epoch: 0; objective: 1.1074434518814087;
fold: TRAIN; iteration: 134; epoch: 0; objective: 1.1902740001678467;
fold: TRAIN; iteration: 135; epoch: 0; objective: 1.0426946878433228;
fold: TRAIN; iteration: 136; epoch: 0; objective: 1.0806156396865845;
fold: TRAIN; iteration: 137; epoch: 0; objective: 1.04219651222229;
fold: TRAIN; iteration: 138; epoch: 0; objective: 1.0237847566604614;
fold: TRAIN; iteration: 139; epoch: 0; objective: 1.0467559099197388;
fold: TRAIN; iteration: 140; epoch: 0; objective: 1.0045491456985474;
fold: TRAIN; iteration: 141; epoch: 0; objective: 1.0031249523162842;
fold: TRAIN; iteration: 142; epoch: 0; objective: 1.0193610191345215;
fold: TRAIN; iteration: 143; epoch: 0; objective: 0.9413273334503174;
fold: TRAIN; iteration: 144; epoch: 0; objective: 0.9462146162986755;
fold: TRAIN; iteration: 145; epoch: 0; objective: 0.9844214916229248;
fold: TRAIN; iteration: 146; epoch: 0; objective: 0.9676988124847412;
fold: TRAIN; iteration: 147; epoch: 0; objective: 1.0017226934432983;
fold: TRAIN; iteration: 148; epoch: 0; objective: 0.9925052523612976;
fold: TRAIN; iteration: 149; epoch: 0; objective: 0.9905155301094055;
validating model...
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "8a25a2975beb4eff962ba4cf64bbc436", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
saving
fold: VALID; iteration: 150; epoch: 0; classification/accuracy: 0.864; objective: 0.93819806377093;
fold: TRAIN; iteration: 150; epoch: 0; objective: 0.8557300567626953;
fold: TRAIN; iteration: 151; epoch: 0; objective: 0.9906383752822876;
fold: TRAIN; iteration: 152; epoch: 0; objective: 0.9624601006507874;
fold: TRAIN; iteration: 153; epoch: 0; objective: 0.993170976638794;
fold: TRAIN; iteration: 154; epoch: 0; objective: 0.9071736931800842;
fold: TRAIN; iteration: 155; epoch: 0; objective: 0.7848459482192993;
fold: TRAIN; iteration: 156; epoch: 0; objective: 0.8039970993995667;
fold: TRAIN; iteration: 157; epoch: 0; objective: 0.9719476103782654;
fold: TRAIN; iteration: 158; epoch: 0; objective: 0.8443021178245544;
fold: TRAIN; iteration: 159; epoch: 0; objective: 0.8998375535011292;
fold: TRAIN; iteration: 160; epoch: 0; objective: 0.8255093097686768;
fold: TRAIN; iteration: 161; epoch: 0; objective: 0.8924367427825928;
fold: TRAIN; iteration: 162; epoch: 0; objective: 0.7872767448425293;
fold: TRAIN; iteration: 163; epoch: 0; objective: 0.8982382416725159;
fold: TRAIN; iteration: 164; epoch: 0; objective: 0.7004592418670654;
fold: TRAIN; iteration: 165; epoch: 0; objective: 0.8574650287628174;
fold: TRAIN; iteration: 166; epoch: 0; objective: 0.6824201345443726;
fold: TRAIN; iteration: 167; epoch: 0; objective: 0.7457051277160645;
fold: TRAIN; iteration: 168; epoch: 0; objective: 0.7597920298576355;
fold: TRAIN; iteration: 169; epoch: 0; objective: 0.7027757167816162;
fold: TRAIN; iteration: 170; epoch: 0; objective: 0.779284656047821;
fold: TRAIN; iteration: 171; epoch: 0; objective: 0.7333415150642395;
fold: TRAIN; iteration: 172; epoch: 0; objective: 0.7395174503326416;
fold: TRAIN; iteration: 173; epoch: 0; objective: 0.717725932598114;
fold: TRAIN; iteration: 174; epoch: 0; objective: 0.7005414366722107;
fold: TRAIN; iteration: 175; epoch: 0; objective: 0.6828017234802246;
fold: TRAIN; iteration: 176; epoch: 0; objective: 0.7340071201324463;
fold: TRAIN; iteration: 177; epoch: 0; objective: 0.6739622354507446;
fold: TRAIN; iteration: 178; epoch: 0; objective: 0.6899915337562561;
fold: TRAIN; iteration: 179; epoch: 0; objective: 0.7609434723854065;
fold: TRAIN; iteration: 180; epoch: 0; objective: 0.723483681678772;
fold: TRAIN; iteration: 181; epoch: 0; objective: 0.6618529558181763;
fold: TRAIN; iteration: 182; epoch: 0; objective: 0.7670478224754333;
fold: TRAIN; iteration: 183; epoch: 0; objective: 0.704923689365387;
fold: TRAIN; iteration: 184; epoch: 0; objective: 0.7382181286811829;
fold: TRAIN; iteration: 185; epoch: 0; objective: 0.6853964924812317;
fold: TRAIN; iteration: 186; epoch: 0; objective: 0.6576809883117676;
fold: TRAIN; iteration: 187; epoch: 0; objective: 0.6633651256561279;
fold: TRAIN; iteration: 188; epoch: 0; objective: 0.6356432437896729;
fold: TRAIN; iteration: 189; epoch: 0; objective: 0.6802909970283508;
fold: TRAIN; iteration: 190; epoch: 0; objective: 0.7543399333953857;
fold: TRAIN; iteration: 191; epoch: 0; objective: 0.6960045099258423;
fold: TRAIN; iteration: 192; epoch: 0; objective: 0.6113891005516052;
fold: TRAIN; iteration: 193; epoch: 0; objective: 0.6340717673301697;
fold: TRAIN; iteration: 194; epoch: 0; objective: 0.6901776790618896;
fold: TRAIN; iteration: 195; epoch: 0; objective: 0.5718191266059875;
fold: TRAIN; iteration: 196; epoch: 0; objective: 0.7135551571846008;
fold: TRAIN; iteration: 197; epoch: 0; objective: 0.6661924719810486;
fold: TRAIN; iteration: 198; epoch: 0; objective: 0.6944522857666016;
fold: TRAIN; iteration: 199; epoch: 0; objective: 0.5633869767189026;
validating model...
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "3ec37b01a4b14945a92878d4d98d8f98", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
saving
fold: VALID; iteration: 200; epoch: 0; classification/accuracy: 0.892; objective: 0.6017566680908203;
fold: TRAIN; iteration: 200; epoch: 0; objective: 0.6165589690208435;
fold: TRAIN; iteration: 201; epoch: 0; objective: 0.6007992029190063;
fold: TRAIN; iteration: 202; epoch: 0; objective: 0.6453073620796204;
fold: TRAIN; iteration: 203; epoch: 0; objective: 0.6578856706619263;
fold: TRAIN; iteration: 204; epoch: 0; objective: 0.5542384386062622;
fold: TRAIN; iteration: 205; epoch: 0; objective: 0.5212136507034302;
fold: TRAIN; iteration: 206; epoch: 0; objective: 0.5677312612533569;
fold: TRAIN; iteration: 207; epoch: 0; objective: 0.6073228716850281;
fold: TRAIN; iteration: 208; epoch: 0; objective: 0.5410568714141846;
fold: TRAIN; iteration: 209; epoch: 0; objective: 0.6119468212127686;
fold: TRAIN; iteration: 210; epoch: 0; objective: 0.5235246419906616;
fold: TRAIN; iteration: 211; epoch: 0; objective: 0.46512195467948914;
fold: TRAIN; iteration: 212; epoch: 0; objective: 0.551405131816864;
fold: TRAIN; iteration: 213; epoch: 0; objective: 0.5503751039505005;
fold: TRAIN; iteration: 214; epoch: 0; objective: 0.5059027671813965;
fold: TRAIN; iteration: 215; epoch: 0; objective: 0.5073906183242798;
fold: TRAIN; iteration: 216; epoch: 0; objective: 0.5828898549079895;
fold: TRAIN; iteration: 217; epoch: 0; objective: 0.5671950578689575;
fold: TRAIN; iteration: 218; epoch: 0; objective: 0.4799307584762573;
fold: TRAIN; iteration: 219; epoch: 0; objective: 0.5336155891418457;
fold: TRAIN; iteration: 220; epoch: 0; objective: 0.500873327255249;
fold: TRAIN; iteration: 221; epoch: 0; objective: 0.5351885557174683;
fold: TRAIN; iteration: 222; epoch: 0; objective: 0.5189544558525085;
fold: TRAIN; iteration: 223; epoch: 0; objective: 0.5437199473381042;
fold: TRAIN; iteration: 224; epoch: 0; objective: 0.49600479006767273;
fold: TRAIN; iteration: 225; epoch: 0; objective: 0.5042865872383118;
fold: TRAIN; iteration: 226; epoch: 0; objective: 0.5432484745979309;
fold: TRAIN; iteration: 227; epoch: 0; objective: 0.46854865550994873;
fold: TRAIN; iteration: 228; epoch: 0; objective: 0.45263436436653137;
fold: TRAIN; iteration: 229; epoch: 0; objective: 0.5405034422874451;
fold: TRAIN; iteration: 230; epoch: 0; objective: 0.5371474623680115;
fold: TRAIN; iteration: 231; epoch: 0; objective: 0.43061327934265137;
fold: TRAIN; iteration: 232; epoch: 0; objective: 0.49482184648513794;
fold: TRAIN; iteration: 233; epoch: 0; objective: 0.42598792910575867;
fold: TRAIN; iteration: 234; epoch: 0; objective: 0.48110923171043396;
fold: TRAIN; iteration: 235; epoch: 0; objective: 0.6314651370048523;
fold: TRAIN; iteration: 236; epoch: 0; objective: 0.4098831117153168;
fold: TRAIN; iteration: 237; epoch: 0; objective: 0.4475633502006531;
fold: TRAIN; iteration: 238; epoch: 0; objective: 0.47540146112442017;
fold: TRAIN; iteration: 239; epoch: 0; objective: 0.4065788686275482;
fold: TRAIN; iteration: 240; epoch: 0; objective: 0.437611848115921;
fold: TRAIN; iteration: 241; epoch: 0; objective: 0.35768526792526245;
fold: TRAIN; iteration: 242; epoch: 0; objective: 0.6634462475776672;
fold: TRAIN; iteration: 243; epoch: 0; objective: 0.4691728353500366;
fold: TRAIN; iteration: 244; epoch: 0; objective: 0.5194788575172424;
fold: TRAIN; iteration: 245; epoch: 0; objective: 0.5108051896095276;
fold: TRAIN; iteration: 246; epoch: 0; objective: 0.39345115423202515;
fold: TRAIN; iteration: 247; epoch: 0; objective: 0.4502719044685364;
fold: TRAIN; iteration: 248; epoch: 0; objective: 0.5285525321960449;
fold: TRAIN; iteration: 249; epoch: 0; objective: 0.4357351064682007;
validating model...
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "aba1e2d97a02478c8e8dd0958d133109", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
saving
fold: VALID; iteration: 250; epoch: 0; classification/accuracy: 0.912; objective: 0.43253763218720753;
fold: TRAIN; iteration: 250; epoch: 0; objective: 0.45614108443260193;
fold: TRAIN; iteration: 251; epoch: 0; objective: 0.37370410561561584;
fold: TRAIN; iteration: 252; epoch: 0; objective: 0.42124831676483154;
fold: TRAIN; iteration: 253; epoch: 0; objective: 0.3984811305999756;
fold: TRAIN; iteration: 254; epoch: 0; objective: 0.3738363981246948;
fold: TRAIN; iteration: 255; epoch: 0; objective: 0.3428247570991516;
fold: TRAIN; iteration: 256; epoch: 0; objective: 0.534629225730896;
fold: TRAIN; iteration: 257; epoch: 0; objective: 0.38350313901901245;
fold: TRAIN; iteration: 258; epoch: 0; objective: 0.44528692960739136;
fold: TRAIN; iteration: 259; epoch: 0; objective: 0.39977115392684937;
fold: TRAIN; iteration: 260; epoch: 0; objective: 0.39737701416015625;
fold: TRAIN; iteration: 261; epoch: 0; objective: 0.44921743869781494;
fold: TRAIN; iteration: 262; epoch: 0; objective: 0.39180126786231995;
fold: TRAIN; iteration: 263; epoch: 0; objective: 0.3643162250518799;
fold: TRAIN; iteration: 264; epoch: 0; objective: 0.44961658120155334;
fold: TRAIN; iteration: 265; epoch: 0; objective: 0.3378368318080902;
fold: TRAIN; iteration: 266; epoch: 0; objective: 0.3428102433681488;
aborting training early...
computing chunk (1/12)
finding documents under filter
done.
processing with lenet
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "e6ebd30e1cc84fc5a4a58ef39b322be3", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
bulk writing...
done.
computing chunk (2/12)
finding documents under filter
done.
processing with lenet
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "e430efcdb7b443649ca92b899e62348c", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
bulk writing...
done.
computing chunk (3/12)
finding documents under filter
done.
processing with lenet
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "b383fab17016487992121113813cf271", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
bulk writing...
done.
computing chunk (4/12)
finding documents under filter
done.
processing with lenet
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "236de98f06c140beb3ae602230350d2d", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
bulk writing...
done.
computing chunk (5/12)
finding documents under filter
done.
processing with lenet
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "0e1fc630490b42a4b429bb616dcb6684", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
bulk writing...
done.
computing chunk (6/12)
finding documents under filter
done.
processing with lenet
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "86f1147171114d599612cfe628a50bcd", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
bulk writing...
done.
computing chunk (7/12)
finding documents under filter
done.
processing with lenet
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "2fa542beb9634f7f84efcf516b6b1450", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
bulk writing...
done.
computing chunk (8/12)
finding documents under filter
done.
processing with lenet
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "915722202c134e9b89110c4520ac8b6c", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
bulk writing...
done.
computing chunk (9/12)
finding documents under filter
done.
processing with lenet
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "252beab80ced48d4b4751c9df71f2e00", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
bulk writing...
done.
computing chunk (10/12)
finding documents under filter
done.
processing with lenet
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "7e94a7974bee43f39f0ccbd07dd87a72", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
bulk writing...
done.
computing chunk (11/12)
finding documents under filter
done.
processing with lenet
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "e1d2225e553f402385d6c5816be041d3", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
bulk writing...
done.
computing chunk (12/12)
finding documents under filter
done.
processing with lenet
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "9c32d2a19549458da9a824f5852dcda4", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
bulk writing...
done.
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[None]
</pre></div></div>
</div>
<p>After training, you‚Äôll see that a model <strong>watcher</strong> has been created, which keeps the <code class="docutils literal notranslate"><span class="pre">img</span></code> key up-to-date</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[15]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">docs</span><span class="o">.</span><span class="n">list_watchers</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[15]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[(&#39;lenet&#39;, &#39;img&#39;)]
</pre></div></div>
</div>
<p>When new data are added, the trained model kicks into action and it‚Äôs outputs are added/ enriched to the newly added data</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[18]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">docs</span><span class="o">.</span><span class="n">insert_many</span><span class="p">([{</span><span class="s1">&#39;img&#39;</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;class&#39;</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]}</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">mnist_data</span><span class="p">[</span><span class="o">-</span><span class="mi">1000</span><span class="p">:]])</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
downloading content from retrieved urls
found 0 urls
computing chunk (1/1)
finding documents under filter
done.
processing with lenet
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "4ba2f87a43a043ceb69da16c2f18c7da", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
bulk writing...
done.
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[18]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;pymongo.results.InsertManyResult at 0x164d3f880&gt;
</pre></div></div>
</div>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="index.html" class="btn btn-neutral float-left" title="MNIST Dataset" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="../coco/index.html" class="btn btn-neutral float-right" title="CoCo (Common Objects in Context) Dataset" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright Duncan Blythe duncan@pinnacledb.com.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>